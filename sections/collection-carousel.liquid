{% if section.blocks.size > 0 %}
  <div class="collection-carousel page-width">
    <div class="carousel-track">
      {% for block in section.blocks %}
        {% assign collection = block.settings.collection %}
        {% if collection %}
          {% assign image = block.settings.image | default: collection.featured_image %}
          {% assign url = block.settings.url | default: collection.url %}

          <a
            href="{{ url }}"
            class="carousel-slide"
            {{ block.shopify_attributes }}
          >
            {% if image %}
              <div class="carousel-image">
                <img
                  src="{{ image | image_url: width: 600 }}"
                  alt="{{ image.alt | escape }}"
                  loading="lazy"
                >
              </div>
            {% endif %}

            <div class="carousel-content">
              {% if block.settings.title != blank %}
                <h3 class="carousel-title">
                  {{ block.settings.title }}
                </h3>
              {% else %}
                <h3 class="carousel-title">
                  {{ collection.title }}
                </h3>
              {% endif %}

              {% if block.settings.description != blank %}
                <p class="carousel-description">
                  {{ block.settings.description }}
                </p>
              {% endif %}
            </div>
          </a>
        {% endif %}
      {% endfor %}
    </div>
  </div>
{% endif %}

{% schema %}
{
  "name": "Collection Carousel",
  "tag": "section",
  "class": "collection-carousel-section",
  "blocks": [
    {
      "type": "slide",
      "name": "Slide",
      "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "Título"
        },
        {
          "type": "textarea",
          "id": "description",
          "label": "Descripción"
        },
        {
          "type": "url",
          "id": "url",
          "label": "URL destino (opcional)"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Imagen (opcional)"
        },
        {
          "type": "collection",
          "id": "collection",
          "label": "Colección"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Collection Carousel"
    }
  ],
  "templates": ["collection"]
}
{% endschema %}
